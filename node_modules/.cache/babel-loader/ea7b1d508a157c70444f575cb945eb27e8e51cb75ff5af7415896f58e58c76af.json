{"ast":null,"code":"import _objectSpread from\"/Users/admin/Desktop/untitled folder/bo_react_test/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from\"react\";import{Grid}from\"@mui/material\";import Input from\"../../../../library/UI/Input\";import{Button}from\"@components/library\";import{useDispatch}from\"react-redux\";import{Controller,useForm}from\"react-hook-form\";import axios from\"@helpers/axios/private.axios\";import PhoneInput from\"react-phone-input-2\";import{post2FASms}from\"@actions/user\";import{useTranslation}from\"@helpers/translate\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const SmsAuthentication=_ref=>{let{setShowWarning}=_ref;const dispatch=useDispatch();const[loading,setLoading]=useState(false);const[showVerification,setShowVerification]=useState(false);const[error,setError]=useState(\"\");const{__}=useTranslation();const{handleSubmit,control,register,formState:{errors,isValid}}=useForm();const onSubmit=_ref2=>{let{phone,code}=_ref2;setLoading(true);if(!showVerification){axios.post(\"/users/2fa/phone/init\",{phone:\"+\"+phone}).then(()=>{setShowVerification(true);setError(\"\");}).catch(error=>{setError(error.response.data.message);}).finally(()=>{setLoading(false);});}else{dispatch(post2FASms({code})).then(()=>{setShowWarning(true);}).catch(error=>{console.log(error,\"error\");}).finally(()=>{setLoading(false);});}};const formChange=()=>{setError(\"\");};return/*#__PURE__*/_jsx(\"form\",{onChange:formChange,onSubmit:handleSubmit(onSubmit),children:/*#__PURE__*/_jsx(Grid,{container:true,columnSpacing:\"1rem\",rowSpacing:\"1.25rem\",children:/*#__PURE__*/_jsx(Grid,{item:true,xl:6,lg:8,xs:12,children:/*#__PURE__*/_jsxs(\"div\",{className:\"authentication__step authentication-step\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"authentication-step__title\",children:__(\"settings.2Step\")}),/*#__PURE__*/_jsx(\"p\",{className:\"authentication-step__text\",children:!showVerification?__(\"settings.2Step_text1\"):/*#__PURE__*/_jsxs(_Fragment,{children:[__(\"settings.2Step_text2\"),/*#__PURE__*/_jsx(\"br\",{}),\"+x xxx xxx xx 71.\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"authentication-step__progress\",children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:\"1rem\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsx(\"div\",{className:\"authentication-step__bar \".concat(!showVerification?\"authentication-step__bar-active\":\"\")})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsx(\"div\",{className:\"authentication-step__bar \".concat(showVerification?\"authentication-step__bar-active\":\"\")})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"authentication-step__inp-wrap\",children:showVerification?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Input,{className:\"bo-input--icon\",data:{type:\"text\",placeholder:\"Enter code\",errors,error,settings:_objectSpread({},register(\"code\",{required:true,minLength:6,maxLength:6,pattern:/^\\d{6}$/})),message:\"\".concat(__(\"error.invalid_code\")),name:\"code\"},children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bo-input__icon bo-input__icon--left bo-input__icon--key\"})}),/*#__PURE__*/_jsx(Button,{type:\"submit\",className:\"authentication-step__btn\",color:\"orange\",size:\"middle\",isLoading:loading,disabled:!isValid,children:__(\"settings.verify\")})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Controller,{name:\"phone\",control:control,rules:{required:true},render:_ref3=>{let{field}=_ref3;return/*#__PURE__*/_jsx(PhoneInput,{value:field.value,specialLabel:false,disableDropdown:true,placeholder:\"+45 (___)___-____\",onChange:e=>field.onChange(e),className:\"\".concat(error?\"error\":\"\",\" bo-input__input\")});}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",className:\"authentication-step__btn\",color:\"orange\",size:\"middle\",isLoading:loading,disabled:!isValid,children:__(\"settings.submit_code\")})]})}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"auth-form__error\",children:error})]})})})});};export default SmsAuthentication;","map":{"version":3,"names":["React","useState","Grid","Input","Button","useDispatch","Controller","useForm","axios","PhoneInput","post2FASms","useTranslation","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","SmsAuthentication","_ref","setShowWarning","dispatch","loading","setLoading","showVerification","setShowVerification","error","setError","__","handleSubmit","control","register","formState","errors","isValid","onSubmit","_ref2","phone","code","post","then","catch","response","data","message","finally","console","log","formChange","onChange","children","container","columnSpacing","rowSpacing","item","xl","lg","xs","className","spacing","concat","type","placeholder","settings","_objectSpread","required","minLength","maxLength","pattern","name","color","size","isLoading","disabled","rules","render","_ref3","field","value","specialLabel","disableDropdown","e"],"sources":["/Users/admin/Desktop/untitled folder/bo_react_test/src/components/pages/Settings/components/Authentication/SmsAuthentication.jsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Grid } from \"@mui/material\";\nimport Input from \"../../../../library/UI/Input\";\nimport { Button } from \"@components/library\";\nimport { useDispatch } from \"react-redux\";\nimport { Controller, useForm } from \"react-hook-form\";\nimport axios from \"@helpers/axios/private.axios\";\nimport PhoneInput from \"react-phone-input-2\";\nimport { post2FASms } from \"@actions/user\";\nimport { useTranslation } from \"@helpers/translate\";\n\nconst SmsAuthentication = ({ setShowWarning }) => {\n  const dispatch = useDispatch();\n  const [loading, setLoading] = useState(false);\n  const [showVerification, setShowVerification] = useState(false);\n  const [error, setError] = useState(\"\");\n  const { __ } = useTranslation();\n\n  const {\n    handleSubmit,\n    control,\n    register,\n    formState: { errors, isValid },\n  } = useForm();\n\n  const onSubmit = ({ phone, code }) => {\n    setLoading(true);\n    if (!showVerification) {\n      axios\n        .post(\"/users/2fa/phone/init\", { phone: \"+\" + phone })\n        .then(() => {\n          setShowVerification(true);\n          setError(\"\");\n        })\n        .catch((error) => {\n          setError(error.response.data.message);\n        })\n        .finally(() => {\n          setLoading(false);\n        });\n    } else {\n      dispatch(post2FASms({ code }))\n        .then(() => {\n          setShowWarning(true);\n        })\n        .catch((error) => {\n          console.log(error, \"error\");\n        })\n        .finally(() => {\n          setLoading(false);\n        });\n    }\n  };\n\n  const formChange = () => {\n    setError(\"\");\n  };\n\n  return (\n    <form onChange={formChange} onSubmit={handleSubmit(onSubmit)}>\n      <Grid container columnSpacing=\"1rem\" rowSpacing=\"1.25rem\">\n        <Grid item xl={6} lg={8} xs={12}>\n          <div className=\"authentication__step authentication-step\">\n            <h3 className=\"authentication-step__title\">\n              {__(\"settings.2Step\")}\n            </h3>\n            <p className=\"authentication-step__text\">\n              {!showVerification ? (\n                __(\"settings.2Step_text1\")\n              ) : (\n                <>\n                  {__(\"settings.2Step_text2\")}\n                  <br />\n                  +x xxx xxx xx 71.\n                </>\n              )}\n            </p>\n            <div className=\"authentication-step__progress\">\n              <Grid container spacing=\"1rem\">\n                <Grid item xs={6}>\n                  <div\n                    className={`authentication-step__bar ${\n                      !showVerification ? \"authentication-step__bar-active\" : \"\"\n                    }`}\n                  ></div>\n                </Grid>\n                <Grid item xs={6}>\n                  <div\n                    className={`authentication-step__bar ${\n                      showVerification ? \"authentication-step__bar-active\" : \"\"\n                    }`}\n                  ></div>\n                </Grid>\n              </Grid>\n            </div>\n            <div className=\"authentication-step__inp-wrap\">\n              {showVerification ? (\n                <>\n                  <Input\n                    className={\"bo-input--icon\"}\n                    data={{\n                      type: \"text\",\n                      placeholder: \"Enter code\",\n                      errors,\n                      error,\n                      settings: {\n                        ...register(\"code\", {\n                          required: true,\n                          minLength: 6,\n                          maxLength: 6,\n                          pattern: /^\\d{6}$/,\n                        }),\n                      },\n                      message: `${__(\"error.invalid_code\")}`,\n                      name: \"code\",\n                    }}\n                  >\n                    <button\n                      type=\"submit\"\n                      className=\"bo-input__icon bo-input__icon--left bo-input__icon--key\"\n                    ></button>\n                  </Input>\n                  <Button\n                    type=\"submit\"\n                    className=\"authentication-step__btn\"\n                    color=\"orange\"\n                    size=\"middle\"\n                    isLoading={loading}\n                    disabled={!isValid}\n                  >\n                    {__(\"settings.verify\")}\n                  </Button>\n                </>\n              ) : (\n                <>\n                  <Controller\n                    name=\"phone\"\n                    control={control}\n                    rules={{ required: true }}\n                    render={({ field }) => (\n                      <PhoneInput\n                        value={field.value}\n                        specialLabel={false}\n                        disableDropdown\n                        placeholder={\"+45 (___)___-____\"}\n                        onChange={(e) => field.onChange(e)}\n                        className={`${error ? \"error\" : \"\"} bo-input__input`}\n                      />\n                    )}\n                  />\n                  <Button\n                    type=\"submit\"\n                    className=\"authentication-step__btn\"\n                    color=\"orange\"\n                    size=\"middle\"\n                    isLoading={loading}\n                    disabled={!isValid}\n                  >\n                    {__(\"settings.submit_code\")}\n                  </Button>\n                </>\n              )}\n            </div>\n\n            {error && <p className=\"auth-form__error\">{error}</p>}\n          </div>\n        </Grid>\n      </Grid>\n    </form>\n  );\n};\n\nexport default SmsAuthentication;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}