{"ast":null,"code":"import _objectSpread from\"/Users/admin/Desktop/untitled folder/bo_react_test/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{FUTURES}from\"../../constants\";import axios from\"@helpers/axios/public.axios\";import store from\"../../redux/store\";export const subscribeToFutureSockets=()=>dispatch=>{const currentPair=store.getState().futures.pair.slug.toLowerCase();const ws=new WebSocket(\"wss://fstream.binance.com/stream?streams=\".concat(currentPair,\"@ticker/\").concat(currentPair,\"@markPrice/\").concat(currentPair,\"@depth10@500ms\"));ws.onmessage=event=>{const data=JSON.parse(event.data);if(data.ping){ws.send(JSON.stringify({pong:data.ping}));return;}if(data){if(data.ping){ws.send(JSON.stringify({pong:data.ping}));return;}if(data.stream===\"\".concat(currentPair,\"@markPrice\")){dispatch({type:FUTURES.CHANGE_MARK_PRICE,payload:data.data.p});return;}if(data.stream===\"\".concat(currentPair,\"@ticker\")){var _state$futures;const{c,P,h,l,v,q}=data.data;const state=store.getState();dispatch({type:FUTURES.CHANGE_TICKER_DATA,payload:_objectSpread(_objectSpread({},state===null||state===void 0?void 0:(_state$futures=state.futures)===null||_state$futures===void 0?void 0:_state$futures.tickerData),{},{lastPrice:c,priceChangePercent:P,highPrice:h,lowPrice:l,volume:v,quoteVolume:q})});dispatch({type:FUTURES.UPDATE_PRICE,payload:c});}// console.log(data.stream, `${currentPair}@depth10@500ms`)\nif(data.stream===\"\".concat(currentPair,\"@depth10@500ms\")){const{a,b}=data.data;dispatch({type:FUTURES.UPDATE_ORDER_BOOK,payload:{asks:a.slice(0,9),bids:b.slice(0,9)}});}}};return()=>{console.log('futures close');if(ws){ws.close();}};};export const getOrderBookData=()=>async dispatch=>{try{const currentPair=store.getState().futures.pair.slug.toLowerCase();dispatch({type:FUTURES.FUTURE_ORDER_BOOK_LOADING,payload:true});const response=await axios.get(\"https://fapi.binance.com/fapi/v1/depth?symbol=\".concat(currentPair,\"&limit=10\"));dispatch({type:FUTURES.UPDATE_ORDER_BOOK,payload:response.data});dispatch({type:FUTURES.FUTURE_ORDER_BOOK_LOADING,payload:false});}catch(error){console.error(\"Error fetching order book:\",error);}};export const getTickerData=()=>async dispatch=>{console.log('getTickerData');try{const currentPair=store.getState().futures.pair.slug.toLowerCase();dispatch({type:FUTURES.FUTURE_TICKERS_LOADING,payload:true});const[tickerRes,markPriceRes]=await Promise.all([axios.get(\"https://fapi.binance.com/fapi/v1/ticker/24hr?symbol=\".concat(currentPair)),axios.get(\"https://fapi.binance.com/fapi/v1/premiumIndex?symbol=\".concat(currentPair))]);const tickerData=tickerRes.data;const markPriceData=markPriceRes.data;dispatch({type:FUTURES.CHANGE_TICKER_DATA,payload:{lastPrice:tickerData.lastPrice,priceChangePercent:tickerData.priceChangePercent,highPrice:tickerData.highPrice,lowPrice:tickerData.lowPrice,volume:tickerData.volume,quoteVolume:tickerData.quoteVolume}});dispatch({type:FUTURES.CHANGE_MARK_PRICE,payload:markPriceData.markPrice});dispatch({type:FUTURES.UPDATE_PRICE,payload:tickerData.lastPrice});dispatch({type:FUTURES.FUTURE_TICKERS_LOADING,payload:false});}catch(error){console.error(\"Error fetching ticker data:\",error);}};","map":{"version":3,"names":["FUTURES","axios","store","subscribeToFutureSockets","dispatch","currentPair","getState","futures","pair","slug","toLowerCase","ws","WebSocket","concat","onmessage","event","data","JSON","parse","ping","send","stringify","pong","stream","type","CHANGE_MARK_PRICE","payload","p","_state$futures","c","P","h","l","v","q","state","CHANGE_TICKER_DATA","_objectSpread","tickerData","lastPrice","priceChangePercent","highPrice","lowPrice","volume","quoteVolume","UPDATE_PRICE","a","b","UPDATE_ORDER_BOOK","asks","slice","bids","console","log","close","getOrderBookData","FUTURE_ORDER_BOOK_LOADING","response","get","error","getTickerData","FUTURE_TICKERS_LOADING","tickerRes","markPriceRes","Promise","all","markPriceData","markPrice"],"sources":["/Users/admin/Desktop/untitled folder/bo_react_test/src/actions/futures/futureData.js"],"sourcesContent":["import {FUTURES} from \"../../constants\";\nimport axios from \"@helpers/axios/public.axios\";\nimport store from \"../../redux/store\";\n\nexport const subscribeToFutureSockets = () => (dispatch) => {\n  const currentPair = store.getState().futures.pair.slug.toLowerCase();\n  const ws = new WebSocket(`wss://fstream.binance.com/stream?streams=${currentPair}@ticker/${currentPair}@markPrice/${currentPair}@depth10@500ms`);\n\n  ws.onmessage = (event) => {\n    const data = JSON.parse(event.data);\n\n    if (data.ping) {\n      ws.send(JSON.stringify({pong: data.ping}));\n      return;\n    }\n\n    if (data) {\n      if (data.ping) {\n        ws.send(JSON.stringify({pong: data.ping}));\n        return;\n      }\n\n      if (data.stream === `${currentPair}@markPrice`) {\n        dispatch({type: FUTURES.CHANGE_MARK_PRICE, payload: data.data.p});\n        return;\n      }\n      if (data.stream === `${currentPair}@ticker`) {\n        const {c, P, h, l, v, q} = data.data;\n        const state = store.getState();\n        dispatch({\n          type: FUTURES.CHANGE_TICKER_DATA, payload: {\n            ...state?.futures?.tickerData,\n            lastPrice: c,\n            priceChangePercent: P,\n            highPrice: h,\n            lowPrice: l,\n            volume: v,\n            quoteVolume: q\n          }\n        });\n\n        dispatch({\n          type: FUTURES.UPDATE_PRICE, payload: c,\n        });\n      }\n\n      // console.log(data.stream, `${currentPair}@depth10@500ms`)\n      \n      if (data.stream === `${currentPair}@depth10@500ms`) {\n        const {a, b} = data.data;\n\n        dispatch({\n          type: FUTURES.UPDATE_ORDER_BOOK, payload: {\n            asks: a.slice(0, 9),\n            bids: b.slice(0, 9),\n          },\n        });\n      }\n    }\n  };\n\n  return () => {\n    console.log('futures close')\n    if (ws) {\n      ws.close();\n    }\n  };\n};\n\nexport const getOrderBookData = () => async (dispatch) => {\n  try {\n    const currentPair = store.getState().futures.pair.slug.toLowerCase();\n\n    dispatch({type: FUTURES.FUTURE_ORDER_BOOK_LOADING, payload: true});\n\n    const response = await axios.get(`https://fapi.binance.com/fapi/v1/depth?symbol=${currentPair}&limit=10`);\n    dispatch({\n      type: FUTURES.UPDATE_ORDER_BOOK, payload: response.data,\n    });\n    dispatch({type: FUTURES.FUTURE_ORDER_BOOK_LOADING, payload: false});\n  } catch (error) {\n    console.error(\"Error fetching order book:\", error);\n  }\n};\n\nexport const getTickerData = () => async (dispatch) => {\n  console.log('getTickerData')\n  try {\n    const currentPair = store.getState().futures.pair.slug.toLowerCase();\n\n    dispatch({type: FUTURES.FUTURE_TICKERS_LOADING, payload: true});\n\n    const [tickerRes, markPriceRes] = await Promise.all([axios.get(`https://fapi.binance.com/fapi/v1/ticker/24hr?symbol=${currentPair}`), axios.get(`https://fapi.binance.com/fapi/v1/premiumIndex?symbol=${currentPair}`)]);\n\n    const tickerData = tickerRes.data;\n    const markPriceData = markPriceRes.data;\n\n    dispatch({\n      type: FUTURES.CHANGE_TICKER_DATA, payload: {\n        lastPrice: tickerData.lastPrice,\n        priceChangePercent: tickerData.priceChangePercent,\n        highPrice: tickerData.highPrice,\n        lowPrice: tickerData.lowPrice,\n        volume: tickerData.volume,\n        quoteVolume: tickerData.quoteVolume,\n      },\n    });\n\n    dispatch({\n      type: FUTURES.CHANGE_MARK_PRICE, payload: markPriceData.markPrice,\n    });\n\n    dispatch({\n      type: FUTURES.UPDATE_PRICE, payload: tickerData.lastPrice,\n    });\n\n    dispatch({type: FUTURES.FUTURE_TICKERS_LOADING, payload: false});\n  } catch (error) {\n    console.error(\"Error fetching ticker data:\", error);\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}