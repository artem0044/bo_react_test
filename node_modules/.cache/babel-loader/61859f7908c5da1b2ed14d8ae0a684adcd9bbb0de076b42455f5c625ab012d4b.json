{"ast":null,"code":"import{WALLET}from\"../../constants\";import axios from\"@helpers/axios/private.axios\";import store from\"../../redux/store\";export const changeWallet=wallet_obj=>async dispatch=>{try{const resp=await axios.post(\"/wallet/change\",{wallet_id:wallet_obj.id});console.log(resp);dispatch({type:WALLET.CHANGE_WALLET,payload:wallet_obj});}catch(error){console.error(error);}};export const getWallets=()=>async dispatch=>{try{dispatch({type:WALLET.WALLET_LOADING});const response=await axios.get(\"/wallet/all\");const data=response.data.data;dispatch({type:WALLET.UPDATE_WALLETS,payload:{wallets:data,realWallet:data.find(el=>el.type===\"real\")}});const activeWallet=data.find(el=>el.active_now===1);console.log(activeWallet);dispatch({type:WALLET.CHANGE_WALLET,payload:activeWallet});return response.data.data;}catch(error){console.error(error);}};export const updateWallets=()=>async dispatch=>{try{const response=await axios.get(\"/wallet/all\");const data=response.data.data;dispatch({type:WALLET.UPDATE_WALLETS,payload:{wallets:data,realWallet:data.find(el=>el.type===\"real\")}});return data;}catch(e){console.error(e);}};export const updateWalletEvent=()=>dispatch=>{let state=store.getState();console.log(\"[updateWalletEvent]\");state.channel.user.listen(\"UpdateBalance\",e=>{const currentState=store.getState();console.log(\"!!!!! EVENT BY SOCKETS [UpdateBalance]:\",e);console.log(e,currentState);const data=[...currentState.wallet.wallets];data.forEach(el=>{if(el.type===e.wallet.type){el.balance=e.wallet.balance;}});dispatch({type:WALLET.UPDATE_WALLETS,payload:{wallets:data,realWallet:data.find(el=>el.type===\"real\")}});});};","map":{"version":3,"names":["WALLET","axios","store","changeWallet","wallet_obj","dispatch","resp","post","wallet_id","id","console","log","type","CHANGE_WALLET","payload","error","getWallets","WALLET_LOADING","response","get","data","UPDATE_WALLETS","wallets","realWallet","find","el","activeWallet","active_now","updateWallets","e","updateWalletEvent","state","getState","channel","user","listen","currentState","wallet","forEach","balance"],"sources":["/Users/admin/Desktop/untitled folder/bo_react_test/src/actions/wallet/changeWallet.js"],"sourcesContent":["import { WALLET } from \"../../constants\";\nimport axios from \"@helpers/axios/private.axios\";\nimport store from \"../../redux/store\";\n\nexport const changeWallet = (wallet_obj) => async (dispatch) => {\n  try {\n    const resp = await axios.post(\"/wallet/change\", {\n      wallet_id: wallet_obj.id,\n    });\n\n    console.log(resp);\n    dispatch({\n      type: WALLET.CHANGE_WALLET,\n      payload: wallet_obj,\n    });\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nexport const getWallets = () => async (dispatch) => {\n  try {\n    dispatch({ type: WALLET.WALLET_LOADING });\n    const response = await axios.get(\"/wallet/all\");\n    const data = response.data.data;\n\n    dispatch({\n      type: WALLET.UPDATE_WALLETS,\n      payload: {\n        wallets: data,\n        realWallet: data.find((el) => el.type === \"real\"),\n      },\n    });\n\n    const activeWallet = data.find((el) => el.active_now === 1);\n\n    console.log(activeWallet)\n    \n    dispatch({\n      type: WALLET.CHANGE_WALLET,\n      payload: activeWallet,\n    });\n\n    return response.data.data;\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nexport const updateWallets = () => async (dispatch) => {\n  try {\n    const response = await axios.get(\"/wallet/all\");\n    const data = response.data.data;\n    dispatch({\n      type: WALLET.UPDATE_WALLETS,\n      payload: {\n        wallets: data,\n        realWallet: data.find((el) => el.type === \"real\"),\n      },\n    });\n    return data;\n  } catch (e) {\n    console.error(e);\n  }\n};\n\nexport const updateWalletEvent = () => (dispatch) => {\n  let state = store.getState();\n  console.log(\"[updateWalletEvent]\");\n  state.channel.user.listen(\"UpdateBalance\", (e) => {\n    const currentState = store.getState();\n    console.log(\"!!!!! EVENT BY SOCKETS [UpdateBalance]:\", e);\n\n    console.log(e, currentState);\n\n    const data = [...currentState.wallet.wallets];\n\n    data.forEach((el) => {\n      if (el.type === e.wallet.type) {\n        el.balance = e.wallet.balance;\n      }\n    });\n    dispatch({\n      type: WALLET.UPDATE_WALLETS,\n      payload: {\n        wallets: data,\n        realWallet: data.find((el) => el.type === \"real\"),\n      },\n    });\n  });\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}